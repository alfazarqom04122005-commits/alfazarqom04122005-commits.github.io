<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tracking WayBill Grid</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  table { width: 100%; border-collapse: collapse; margin-top: 20px; }
  th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
  th { background-color: #f4f4f4; }
  button { padding: 5px 10px; cursor: pointer; }
  /* Modal style */
  .modal { display: none; position: fixed; z-index: 10; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); }
  .modal-content { background-color: #fff; margin: 10% auto; padding: 20px; border-radius: 5px; width: 80%; max-width: 600px; }
  .modal-content input { width: 100%; padding: 5px; margin: 5px 0; }
</style>
</head>
<body>

<h1>Tracking WayBill</h1>
<table id="waybill-table">
  <thead>
    <tr id="table-headers"></tr>
  </thead>
  <tbody id="table-body"></tbody>
</table>

<!-- Modal -->
<div id="edit-modal" class="modal">
  <div class="modal-content">
    <h2>Edit Item</h2>
    <form id="edit-form"></form>
    <button id="save-btn">Save</button>
    <button id="close-btn">Cancel</button>
  </div>
</div>

<script>
const jsonResponse = {
  "range": "Sheet1!A1:Z1000",
  "majorDimension": "ROWS",
  "values": [
    ["wayBill","namaPengirim","namaPenerima","alamatPengiriman","kotaPengirim","tanggalKirim","statusPengiriman","keterangan","metodePelayanan","berat","jumlah","metodeLayananDelivery"],
    ["JNT1234567890","PT ABC,Andi Wijaya","tedong","Jl. Sudirman No.10","mkasaar","2025-08-17","Sedang di proses","Proses asuransi","sf","kj","kj","jk"],
    ["JT1234567890d","PT ABC,Andi Wijaya","tedong","Jl. Sudirman No.10","mkasaar","2025-08-17","Sedang di proses","Proses asuransi"]
  ]
};

const headers = jsonResponse.values[0];
const rows = jsonResponse.values.slice(1);

const headersRow = document.getElementById("table-headers");
headers.forEach(header => {
  const th = document.createElement("th");
  th.textContent = header;
  headersRow.appendChild(th);
});
const thEdit = document.createElement("th");
thEdit.textContent = "Actions";
headersRow.appendChild(thEdit);

const tableBody = document.getElementById("table-body");
rows.forEach((row, rowIndex) => {
  const tr = document.createElement("tr");
  headers.forEach((_, index) => {
    const td = document.createElement("td");
    td.textContent = row[index] || "";
    tr.appendChild(td);
  });

  // Tambahkan tombol edit
  const tdAction = document.createElement("td");
  const editBtn = document.createElement("button");
  editBtn.textContent = "Edit";
  editBtn.addEventListener("click", () => openModal(rowIndex));
  tdAction.appendChild(editBtn);
  tr.appendChild(tdAction);

  tableBody.appendChild(tr);
});

// Modal
const modal = document.getElementById("edit-modal");
const form = document.getElementById("edit-form");
let currentEditIndex = null;

function openModal(index) {
  currentEditIndex = index;
  form.innerHTML = "";
  const row = rows[index];
  headers.forEach((header, i) => {
    const input = document.createElement("input");
    input.name = header;
    input.value = row[i] || "";
    input.placeholder = header;
    form.appendChild(input);
  });
  modal.style.display = "block";
}

document.getElementById("save-btn").addEventListener("click", () => {
  const inputs = form.querySelectorAll("input");
  inputs.forEach((input, i) => {
    rows[currentEditIndex][i] = input.value;
    tableBody.rows[currentEditIndex].cells[i].textContent = input.value;
  });
  modal.style.display = "none";
});

document.getElementById("close-btn").addEventListener("click", () => {
  modal.style.display = "none";
});

// Tutup modal saat klik di luar
window.addEventListener("click", (e) => {
  if (e.target === modal) modal.style.display = "none";
});
</script>
</body>
</html>
